<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>È≠îÊ≥ïÂ∑•Ëâ∫‰πùÂÆ´Ê†ºÁÜÑÁÅØÂ∞èÊ∏∏ÊàèËß£ÂØÜÂ∑•ÂÖ∑</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { 
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            padding: 10px; 
            color: #eee;
            position: relative;
            overflow-x: hidden;
        }
        .bg-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('/img/bj.jpg');
            background-size: cover;
            background-position: center;
            filter: blur(20px) brightness(0.7);
            opacity: 0.6;
            z-index: -2;
            pointer-events: none;
        }
        .container { 
            width: 100%; 
            max-width: 400px; 
            background: rgba(0, 0, 0, 0.25);
            backdrop-filter: blur(12px) saturate(180%) brightness(0.8);
            -webkit-backdrop-filter: blur(12px) saturate(180%) brightness(0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border-radius: 20px; 
            padding: 20px; 
        }
        h1 { 
            text-align: center; 
            color: #fff; 
            font-size: 22px; 
            margin-bottom: 6px; 
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        .subtitle { 
            text-align: center; 
            color: #bdc3c7; 
            font-size: 13px; 
            margin-bottom: 20px; 
        }
        .solution { 
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            padding: 12px; 
            border-radius: 12px; 
            margin-bottom: 20px; 
        }
        .solution-title { 
            font-size: 14px; 
            color: #ddd; 
            margin-bottom: 6px; 
        }
        .solution-steps { 
            font-size: 18px; 
            color: #5dade2; 
            text-align: center; 
            font-weight: bold; 
            min-height: 24px; 
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }
        .mode { 
            display: flex; 
            gap: 8px; 
            margin-bottom: 20px; 
        }
        .mode-btn { 
            flex: 1; 
            padding: 10px; 
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px; 
            color: #ddd; 
            font-weight: 600; 
            cursor: pointer; 
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            transition: all 0.3s ease;
        }
        .mode-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        .mode-btn.active { 
            background: rgba(52, 152, 219, 0.7);
            color: white; 
            border-color: rgba(52, 152, 219, 0.5);
        }
        .controls { 
            display: flex; 
            gap: 8px; 
            margin-bottom: 20px; 
        }
        .control-btn { 
            flex: 1; 
            padding: 14px 8px; 
            border: none; 
            border-radius: 12px; 
            font-weight: 600; 
            cursor: pointer; 
            color: white; 
            font-size: 14px; 
            text-align: center; 
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
        }
        .new-game { 
            background: rgba(46, 204, 113, 0.7); 
        }
        .special { 
            background: rgba(155, 89, 182, 0.7); 
        }
        .solve { 
            background: rgba(231, 76, 60, 0.7); 
        }
        .info { 
            text-align: center; 
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            padding: 12px; 
            border-radius: 12px; 
            margin-bottom: 20px; 
            font-size: 15px; 
            color: #fff; 
        }
        .board { 
            display: grid; 
            grid-template-columns: repeat(3, 1fr); 
            gap: 10px; 
            width: 260px; 
            height: 260px; 
            margin: 0 auto; 
        }
        .light        </div>
        <div class="mode">
            <button class="mode-btn active" id="randomModeBtn">ÈöèÊú∫Ê®°ÂºèÁªÉ‰π†ÂÆ§</button>
            <button class="mode-btn" id="customModeBtn">Ê∏∏ÊàèÂÜÖÂΩìÂâçËÆæÁΩÆ</button>
        </div>
        <div class="controls">
            <button class="control-btn new-game" id="newGameBtn">ÈáçÁΩÆÊ∏∏Êàè</button>
            <button class="control-btn special" id="specialPatternBtn">Âè™Êúâ‰∏Ä‰∏™ÁÅ≠ÁÅØÊ®°Âºè</button>
            <button class="control-btn solve" id="solveBtn">Ëß£ÂØÜÊ≠•È™§</button>
        </div>
        <div class="info" id="gameInfo">ÁÇπÂáªÂºÄÂßãÊ∏∏Êàè</div>
        <div class="board" id="gameBoard"></div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            let gameMode = 'random';
            let lights = Array(9).fill(false);
            const boardElement = document.getElementById('gameBoard');
            const gameInfoElement = document.getElementById('gameInfo');
            const solutionStepsElement = document.getElementById('solutionSteps');

            function initBoard() {
                boardElement.innerHTML = '';
                for (let i = 0; i < 9; i++) {
                    const lightElement = document.createElement('div');
                    lightElement.className = 'light off';
                    lightElement.textContent = i + 1;
                    lightElement.dataset.index = i;
                    lightElement.addEventListener('click', () => toggleLight(i));
                    boardElement.appendChild(lightElement);
                }
                updateBoard();
            }

            function updateBoard() {
                const lightElements = document.querySelectorAll('.light');
                lightElements.forEach((element, index) => {
                    if (lights[index]) {
                        element.classList.remove('off');
                        element.classList.add('on');
                    } else {
                        element.classList.remove('on');
                        element.classList.add('off');
                    }
                });
                const onCount = lights.filter(light => light).length;
                gameInfoElement.textContent = `Â∑≤ÁÇπ‰∫Æ: ${onCount}/9`;
                if (onCount === 9) {
                    gameInfoElement.innerHTML = `üéâ ÊÅ≠ÂñúÔºÅÂÖ®ÈÉ®ÁÇπ‰∫ÆÔºÅ`;
                    gameInfoElement.style.color = '#2ecc71';
                } else {
                    gameInfoElement.style.color = '#2c3e50';
                }
            }

            function toggleLight(index) {
                if (gameMode === 'random') {
                    toggleSingleLight(index);
                    if (index >= 3) toggleSingleLight(index - 3);
                    if (index <= 5) toggleSingleLight(index + 3);
                    if (index % 3 !== 0) toggleSingleLight(index - 1);
                    if (index % 3 !== 2) toggleSingleLight(index + 1);
                } else {
                    toggleSingleLight(index);
                }
                updateBoard();
            }

            function toggleSingleLight(index) {
                lights[index] = !lights[index];
            }

            function newRandomGame() {
                solutionStepsElement.textContent = '';
                const onCount = Math.floor(Math.random() * 9);
                const indices = Array.from({length: 9}, (_, i) => i);
                for (let i = indices.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [indices[i], indices[j]] = [indices[j], indices[i]];
                }
                lights = Array(9).fill(false);
                for (let i = 0; i < onCount; i++) {
                    lights[indices[i]] = true;
                }
                updateBoard();
            }

            function specialPattern() {
                solutionStepsElement.textContent = 'ÁÇπÂáªËß£ÂØÜÂèØËé∑ÂèñËß£ÂØÜÊ≠•È™§';
                lights = Array(9).fill(true);
                const randomIndex = Math.floor(Math.random() * 9);
                lights[randomIndex] = false;
                updateBoard();
            }

            function calculateSolution() {
                const matrix = [];
                for (let i = 0; i < 9; i++) {
                    const row = Array(9).fill(0);
                    row[i] = 1;
                    if (i >= 3) row[i - 3] = 1;
                    if (i <= 5) row[i + 3] = 1;
                    if (i % 3 !== 0) row[i - 1] = 1;
                    if (i % 3 !== 2) row[i + 1] = 1;
                    matrix.push(row);
                }
                const target = lights.map(light => light ? 0 : 1);
                const solution = gaussianElimination(matrix, target);
                if (solution) {
                    const steps = [];
                    for (let i = 0; i < 9; i++) {
                        if (solution[i] === 1) steps.push(i + 1);
                    }
                    solutionStepsElement.textContent = steps.length === 0 ? "Êó†ÈúÄÊìç‰Ωú" : steps.join('-');
                } else {
                    solutionStepsElement.textContent = "Êó†Ëß£";
                }
            }

            function gaussianElimination(A, b) {
                const n = 9;
                let matrix = A.map((row, i) => [...row, b[i]]);
                for (let col = 0; col < n; col++) {
                    let pivot = -1;
                    for (let row = col; row < n; row++) {
                        if (matrix[row][col] === 1) {
                            pivot = row;
                            break;
                        }
                    }
                    if (pivot === -1) continue;
                    [matrix[col], matrix[pivot]] = [matrix[pivot], matrix[col]];
                    for (let row = 0; row < n; row++) {
                        if (row !== col && matrix[row][col] === 1) {
                            for (let j = col; j <= n; j++) {
                                matrix[row][j] ^= matrix[col][j];
                            }
                        }
                    }
                }
                const solution = new Array(n).fill(0);
                for (let i = 0; i < n; i++) {
                    if (matrix[i][i] === 1) {
                        solution[i] = matrix[i][n];
                    } else if (matrix[i][n] === 1) {
                        return null;
                    }
                }
                return solution;
            }

            document.getElementById('randomModeBtn').addEventListener('click', function() {
                gameMode = 'random';
                document.getElementById('randomModeBtn').classList.add('active');
                document.getElementById('customModeBtn').classList.remove('active');
                gameInfoElement.textContent = "Ëµ∂Âø´ÁªÉ‰π†ÂêßÔºåÈïøËææ‰∏§Âπ¥ÂçäÁöÑÁªÉ‰π†Áîü";
            });
            document.getElementById('customModeBtn').addEventListener('click', function() {
                gameMode = 'custom';
                document.getElementById('customModeBtn').classList.add('active');
                document.getElementById('randomModeBtn').classList.remove('active');
                gameInfoElement.textContent = "ËØ∑Ê†πÊçÆÊ∏∏ÊàèÂÜÖÁöÑÊ†ºÂ≠êËÆæÁΩÆÔºåÈªÑËâ≤‰ª£Ë°®Â∑≤‰∫Æ";
            });
            document.getElementById('newGameBtn').addEventListener('click', newRandomGame);
            document.getElementById('specialPatternBtn').addEventListener('click', specialPattern);
            document.getElementById('solveBtn').addEventListener('click', calculateSolution);

            initBoard();
            newRandomGame();
        });
    </script>
</body>
</html>
